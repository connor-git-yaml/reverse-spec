# Speckit Driver Pro - 驱动配置文件
# 预设: quality-first（所有阶段均使用 Opus）

preset: quality-first

agents:
  product-research:
    model: opus
  tech-research:
    model: opus
  specify:
    model: opus
  plan:
    model: opus
  analyze:
    model: opus
  clarify:
    model: opus
  checklist:
    model: opus
  tasks:
    model: opus
  implement:
    model: opus
  verify:
    model: opus

# ═══════════════════════════════════════
# 调研阶段配置（Feature 模式）
# ═══════════════════════════════════════
# 控制 Feature 模式中调研阶段的行为
# Story 模式和 Fix 模式不受此配置影响
#
# default_mode 可选值:
#   auto          — 由编排器根据需求特征智能推荐（默认）
#   full          — 完整调研（产品+技术+汇总），与当前版本行为一致
#   tech-only     — 仅技术调研（跳过产品调研和汇总）
#   product-only  — 仅产品调研（跳过技术调研和汇总）
#   codebase-scan — 代码库上下文扫描（与 Story 模式相同）
#   skip          — 跳过调研（不执行任何调研步骤）
#   custom        — 自定义步骤组合（需配置 custom_steps）
#
research:
  default_mode: auto

  # 自定义步骤（仅当 default_mode: custom 时生效）
  # 可选步骤: product-research, tech-research, codebase-scan, synthesis
  # 注意: synthesis 依赖 product-research 和 tech-research 的输出
  custom_steps: []

verification:
  commands: {}
  monorepo:
    enabled: true

quality_gates:
  auto_continue_on_warning: true
  pause_on_critical: true

# 门禁策略: strict | balanced | autonomous
# 注：GATE_DESIGN 在 feature 模式下始终暂停（硬门禁），不受此配置影响
gate_policy: balanced

# 门禁级配置（高级，可选）
# 对每个门禁独立配置，优先于 gate_policy
# 可选值: always | auto | on_failure
# gates:
#   GATE_RESEARCH:
#     pause: auto
#   GATE_DESIGN:
#     pause: always
#   GATE_ANALYSIS:
#     pause: auto
#   GATE_TASKS:
#     pause: always
#   GATE_VERIFY:
#     pause: always

retry:
  max_attempts: 2

progress:
  show_stage_progress: true
  show_stage_summary: true
