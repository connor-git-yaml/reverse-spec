# Speckitdriver - 驱动配置文件
# 文件位置: 项目根目录/driver-config.yaml 或 .specify/driver-config.yaml
# 首次使用时由 init-project.sh 交互式引导创建

# ═══════════════════════════════════════
# 模型预设
# ═══════════════════════════════════════
# 可选值: balanced | quality-first | cost-efficient
#
# balanced（默认）:
#   重分析任务（调研、规范、规划、分析）使用 Opus
#   执行任务（澄清、检查表、任务分解、实现、验证）使用 Sonnet
#
# quality-first:
#   所有阶段均使用 Opus（最高质量，成本较高）
#
# cost-efficient:
#   所有阶段均使用 Sonnet（成本最低，适合探索性需求）
#
preset: balanced

# ═══════════════════════════════════════
# 子代理模型配置（覆盖预设）
# ═══════════════════════════════════════
# 每个子代理可独立配置 model 字段
# 可选值: opus | sonnet
# 取消注释并修改以覆盖预设中的默认值
#
agents:
  # --- 重分析任务（balanced 预设下默认 opus）---
  product-research:
    model: opus
  tech-research:
    model: opus
  specify:
    model: opus
  plan:
    model: opus
  analyze:
    model: opus

  # --- 执行任务（balanced 预设下默认 sonnet）---
  clarify:
    model: sonnet
  checklist:
    model: sonnet
  tasks:
    model: sonnet
  implement:
    model: sonnet
  verify:
    model: sonnet

# ═══════════════════════════════════════
# 验证阶段配置
# ═══════════════════════════════════════
verification:
  # 自定义构建/Lint/测试命令
  # 键名为语言标识（小写），覆盖自动检测的默认命令
  # 取消注释并修改以使用自定义命令
  commands: {}
    # typescript:
    #   build: "npm run build"
    #   lint: "npm run lint"
    #   test: "npm test"
    # python:
    #   lint: "ruff check ."
    #   test: "pytest -v"
    # rust:
    #   lint: "cargo clippy -- -D warnings"
    #   test: "cargo test --all-features"

  # Monorepo 子项目检测
  monorepo:
    enabled: true  # 是否启用 Monorepo 子项目自动检测

# ═══════════════════════════════════════
# 质量门配置
# ═══════════════════════════════════════
quality_gates:
  # WARNING 级别发现时自动继续（不暂停）
  auto_continue_on_warning: true
  # CRITICAL 级别发现时暂停（此设置不可关闭，仅供参考）
  pause_on_critical: true

# ═══════════════════════════════════════
# 子代理重试策略
# ═══════════════════════════════════════
retry:
  # 子代理失败后自动重试的最大次数
  # 超过此次数后暂停，等待用户决策（重试/跳过/中止）
  max_attempts: 2

# ═══════════════════════════════════════
# 进度输出配置
# ═══════════════════════════════════════
progress:
  # 阶段开始/完成时输出进度信息（如 "[3/10] 正在执行技术规划..."）
  show_stage_progress: true
  # 阶段完成时输出关键产出摘要
  show_stage_summary: true
